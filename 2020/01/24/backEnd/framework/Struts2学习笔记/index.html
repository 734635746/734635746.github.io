<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/small_favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="PtW_W-vL1bcbJqbBxi7Pkju0LjbSY_gfU_-FBrviSX4">
  <meta name="baidu-site-verification" content="hrntsrnjwc">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://liuyoubin.top').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="虽然 Struts2已经不流行了 ┌(;￣◇￣)┘，但还是整理了以前学习Struts2的笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="struts2学习笔记">
<meta property="og:url" content="http://liuyoubin.top/2020/01/24/backEnd/framework/Struts2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="何处似樽前">
<meta property="og:description" content="虽然 Struts2已经不流行了 ┌(;￣◇￣)┘，但还是整理了以前学习Struts2的笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note.youdao.com/yws/public/resource/95dc5fd583515e098ac1c0633b7c4216/xmlnote/116E3C76607848498F473A995E5CC6FB/4699">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/25/1epgCq.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/25/1e99IA.png">
<meta property="article:published_time" content="2020-01-24T15:39:50.000Z">
<meta property="article:modified_time" content="2020-02-03T07:30:11.813Z">
<meta property="article:author" content="liuyoubin">
<meta property="article:tag" content="Struts2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note.youdao.com/yws/public/resource/95dc5fd583515e098ac1c0633b7c4216/xmlnote/116E3C76607848498F473A995E5CC6FB/4699">

<link rel="canonical" href="http://liuyoubin.top/2020/01/24/backEnd/framework/Struts2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>struts2学习笔记 | 何处似樽前</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6113feeaa36afe6bf4ddacebd35dab86";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="何处似樽前" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
	
	
	
	<a href="https://github.com/734635746" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
	
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">何处似樽前</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">博观而约取，厚积而薄发</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">26</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">7</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">31</span></a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://liuyoubin.top/2020/01/24/backEnd/framework/Struts2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xfc.jpg">
      <meta itemprop="name" content="liuyoubin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何处似樽前">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          struts2学习笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-01-24 23:39:50" itemprop="dateCreated datePublished" datetime="2020-01-24T23:39:50+08:00">2020-01-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-02-03 15:30:11" itemprop="dateModified" datetime="2020-02-03T15:30:11+08:00">2020-02-03</time>
              </span>
			
			<span class="post-meta-divider">|</span>
			<span title="post.wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span>字数： 7.4k</span>
			
			<span class="post-meta-divider">|</span>
			<span title="post.min2read"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span>阅读时长≈ 35min</span>
			
			<span class="post-meta-divider">|</span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">笔记</span>
                  </a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AC%94%E8%AE%B0/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index">
                    <span itemprop="name">后端</span>
                  </a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AC%94%E8%AE%B0/%E5%90%8E%E7%AB%AF/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index">
                    <span itemprop="name">框架</span>
                  </a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="note info">
            <p>虽然 Struts2已经不流行了 ┌(;￣◇￣)┘，但还是整理了以前学习Struts2的笔记  </p>
          </div>

<a id="more"></a>

<h1 id="Struts2入门"><a href="#Struts2入门" class="headerlink" title="Struts2入门"></a>Struts2入门</h1><h2 id="搭建struts2项目的步骤"><a href="#搭建struts2项目的步骤" class="headerlink" title="搭建struts2项目的步骤"></a>搭建struts2项目的步骤</h2><ol>
<li>新建web项目</li>
<li>导入所需的jar包</li>
<li>配置web.xml文件（配置struts2的核心控制器）</li>
</ol>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">filter</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">filter</span>-<span class="type">name</span>&gt;struts2&lt;/<span class="keyword">filter</span>-<span class="type">name</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">filter</span>-<span class="keyword">class</span>&gt;org.apache.struts2.dispatcher.ng.<span class="keyword">filter</span>.StrutsPrepareAndExecuteFilter&lt;/<span class="keyword">filter</span>-<span class="keyword">class</span>&gt;//注意如果struts2的版本是<span class="number">2.5</span>要去掉.ng</span><br><span class="line">&lt;/<span class="keyword">filter</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">filter</span>-<span class="keyword">mapping</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">filter</span>-<span class="type">name</span>&gt;struts2&lt;/<span class="keyword">filter</span>-<span class="type">name</span>&gt;</span><br><span class="line">    &lt;url-pattern&gt;<span class="comment">/*&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">&lt;/filter-mapping&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>在src下新建struts2的配置文件（<strong>struts.xml</strong>）<blockquote>
<p>XML文件的头文件可以直接在一个struts.xml文件里面拷贝，也可以在struts-core包下面的struts-default.xml里面拷贝</p>
</blockquote>
</li>
</ol>
<p>==注意：到这里struts框架已经搭建完成==</p>
<ol start="5">
<li>编写Action类 </li>
</ol>
<ul>
<li><p>在servlet中默认执行service方法，在struts中默认执行execute方法</p>
</li>
<li><p>在servlet中默认执行service方法，在struts中默认执行execute方法</p>
</li>
<li><p>在servlet的service方法中的参数是HttpServletRequest和HttpServletResponse，无返回值</p>
</li>
<li><p>在struts2中的方法都是public的，且无参数，返回值都为String</p>
</li>
</ul>
<ol start="6">
<li>在struts.xml中配置action类<blockquote>
<p>struts2是基于包来管理的，同样也是基于包来进行配置</p>
</blockquote>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- extends必须写，直接或间接继承struts-default，name自定义  namespace为命名空间--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">“/”</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- name写请求名称 ;class是对应action的完全限定名--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"com.lyb.action.HelloAction"</span> &gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- result是结果集 --&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- name与对应action中方法的返回值匹配，默认为success --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="struts2执行流程"><a href="#struts2执行流程" class="headerlink" title="struts2执行流程"></a>struts2执行流程</h2><blockquote>
<p>当用户提交一个请求，服务器接收，并交给struts2的核心过滤器来进行处理，struts2的过滤器调用struts2的一系列处理器来处理（如解析struts2.xml配置文件；和用户请求进行比对），直到调用对应的action类中的方法执行，执行完后再进行一系列处理到核心过滤器。由核心过滤器返回给服务器，服务器对浏览器进行响应。</p>
</blockquote>
<h2 id="详细流程"><a href="#详细流程" class="headerlink" title="详细流程"></a>详细流程</h2><p><img src="https://note.youdao.com/yws/public/resource/95dc5fd583515e098ac1c0633b7c4216/xmlnote/116E3C76607848498F473A995E5CC6FB/4699" alt="image"></p>
<h2 id="用struts2搭建一个简单登陆案例"><a href="#用struts2搭建一个简单登陆案例" class="headerlink" title="用struts2搭建一个简单登陆案例"></a>用struts2搭建一个简单登陆案例</h2><p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"3.1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Struts2Demo<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.htm<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.htm<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.action<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>struts.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.5.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- extends必须写，直接或间接继承struts-default，name自定义 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- name写请求名称 ;class是对应action的完全限定名--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"login1"</span> <span class="attr">class</span>=<span class="string">"com.lyb.action.LoginAction"</span> &gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- result是结果集 --&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- name与对应action中方法的返回值匹配，默认为success --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"failed"</span>&gt;</span>login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Action类</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package com.lyb.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginAction</span> &#123;</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> pwd;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(name.equals(<span class="string">"lyb"</span>)&amp;&amp;pwd.equals(<span class="string">"123"</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"failed"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getPwd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> pwd;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPwd</span><span class="params">(<span class="keyword">String</span> pwd)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>login.jsp</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=utf-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"utf-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>登陆界面<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"login1.action"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">		用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登陆"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>index.jsp</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=utf-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"utf-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">b</span>&gt;</span>登陆成功<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="struts2线程安全问题"><a href="#struts2线程安全问题" class="headerlink" title="struts2线程安全问题"></a>struts2线程安全问题</h1><h2 id="线程安全的概念"><a href="#线程安全的概念" class="headerlink" title="线程安全的概念"></a>线程安全的概念</h2><p>在拥有共享数据的多条线程并行执行的程序中，线程安全的代码会通过同步机制保证各个线程都可以正常且正确的执行，不会出现数据污染等意外情况。</p>
<h2 id="struts2线程安全？"><a href="#struts2线程安全？" class="headerlink" title="struts2线程安全？"></a>struts2线程安全？</h2><p>每次请求都会重新创建action对象（多例），所以struts2是==线程安全==的</p>
<p>由于action对象是struts2反射生成的，所以action类要求要有一个公共的无参构造方法</p>
<h1 id="action的实现方式以及表单数据的处理"><a href="#action的实现方式以及表单数据的处理" class="headerlink" title="action的实现方式以及表单数据的处理"></a>action的实现方式以及表单数据的处理</h1><h2 id="action的三种实现方法"><a href="#action的三种实现方法" class="headerlink" title="action的三种实现方法"></a>action的三种实现方法</h2><ul>
<li>自定义一个pojo类</li>
</ul>
<p>好处：不具有侵入性，容易更改、测试</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloAction</span>&#123;</span> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.printfln(<span class="string">"pojo execute!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>实现Action接口</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">HelloAction</span> <span class="symbol">implement</span> <span class="symbol">Action</span>&#123; </span><br><span class="line">    <span class="keyword">public</span> String execute() throws Exception&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.printfln(<span class="string">"pojo execute!"</span>);</span><br><span class="line">        <span class="keyword">return</span> SUCCESS;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>好处：使编码更加规范</p>
</li>
<li><p>继承ActionSupport</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">HelloAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span></span>&#123; </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>好处：可以使用ActionSupport实现的功能 如：验证</p>
</li>
</ul>
<h2 id="以对象的方式处理表单数据"><a href="#以对象的方式处理表单数据" class="headerlink" title="以对象的方式处理表单数据"></a>以对象的方式处理表单数据</h2><h3 id="属性驱动"><a href="#属性驱动" class="headerlink" title="属性驱动"></a>属性驱动</h3><p>jsp页面</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">form</span> action=<span class="string">""</span> &gt;</span><br><span class="line">    姓名：&lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"text"</span> name=<span class="string">"user.name"</span> /&gt;&lt;<span class="keyword">br</span>&gt;</span><br><span class="line">    年龄：&lt;<span class="keyword">input</span> <span class="keyword">type</span>=:text<span class="string">" name="</span>user.age" /&gt;&lt;<span class="keyword">br</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"submit"</span> value=<span class="string">"确定"</span>/&gt;</span><br><span class="line">&lt;<span class="keyword">form</span>&gt;</span><br></pre></td></tr></table></figure>
<p>vo类</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">String</span> <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="comment">//get set方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>action类</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAction</span>&#123;</span></span><br><span class="line">    <span class="keyword">private</span> User user;<span class="comment">//注意这里的属性全部用小写，否则设置不会成功</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//set get 方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="模型驱动（ModelDriven）"><a href="#模型驱动（ModelDriven）" class="headerlink" title="模型驱动（ModelDriven）"></a>模型驱动（ModelDriven）</h3><p>jsp页面</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">form</span> action=<span class="string">""</span> &gt;</span><br><span class="line">    姓名：&lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"text"</span> name=<span class="string">"name"</span> /&gt;&lt;<span class="keyword">br</span>&gt;</span><br><span class="line">    年龄：&lt;<span class="keyword">input</span> <span class="keyword">type</span>=:text<span class="string">" name="</span>age" /&gt;&lt;<span class="keyword">br</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"submit"</span> value=<span class="string">"确定"</span>/&gt;</span><br><span class="line">&lt;<span class="keyword">form</span>&gt;</span><br></pre></td></tr></table></figure>
<p>vo类</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">String</span> <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="comment">//get set方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>action类</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> UserAction implements ModelDriven&lt;<span class="keyword">User</span>&gt;&#123;</span><br><span class="line">    private <span class="keyword">User</span> <span class="keyword">user</span> = <span class="built_in">new</span> <span class="keyword">User</span>();</span><br><span class="line">    </span><br><span class="line">    //<span class="keyword">get</span> <span class="keyword">set</span>方法</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">public</span> String <span class="keyword">execute</span>()&#123;</span><br><span class="line">        <span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">public</span> <span class="keyword">User</span> getModel()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">user</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="struts2配置文件详解"><a href="#struts2配置文件详解" class="headerlink" title="struts2配置文件详解"></a>struts2配置文件详解</h1><ul>
<li>配置文件名称</li>
</ul>
<p>struts2配置文件以struts.xml为名称，不能随意更改</p>
<ul>
<li>struts.xml头文件</li>
</ul>
<p>XML文件的头文件可以直接在一个struts.xml文件里面拷贝，也可以在struts-core包下面的struts-default.xml里面拷贝</p>
<p>下面为struts2 2.5版本的struts.xml的头文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.5.dtd"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="struts-xml的标签"><a href="#struts-xml的标签" class="headerlink" title="struts.xml的标签"></a>struts.xml的标签</h2><h3 id="constant标签"><a href="#constant标签" class="headerlink" title="constant标签"></a>constant标签</h3><p>作用：配置struts属性</p>
<ul>
<li>解决乱码问题（配置编码格式）</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">constant</span> <span class="type">name</span>="struts.i18n.encoding" <span class="keyword">value</span>="UTF-8"&gt;&lt;/<span class="keyword">constant</span>&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>自定义扩展名</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">constant</span> <span class="type">name</span>="struts.action.extension" <span class="keyword">value</span>="action,,lyb"&gt;&lt;/<span class="keyword">constant</span>&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置开发者模式</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">constant</span> <span class="type">name</span>="struts.devMode" <span class="keyword">value</span>="true"&gt;&lt;/<span class="keyword">constant</span>&gt;</span><br></pre></td></tr></table></figure>
<p>但设置为true时，会启动错误友好提醒模式</p>
<ul>
<li>设置配置文件修改时自动加载 —推荐开发时使用<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">constant</span> <span class="type">name</span>="struts.devMode" <span class="keyword">value</span>="true"&gt;&lt;/<span class="keyword">constant</span>&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>注：上面常量配置的一种方式；也可以在src下新建==struts.properties==文件进行常量配置</p>
<h3 id="include标签"><a href="#include标签" class="headerlink" title="include标签"></a>include标签</h3><p>作用：引入文件，方便团队协作管理维护</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">include</span> <span class="keyword">file</span>=<span class="string">"com/lyb/struts/user.xml"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h3 id="package标签"><a href="#package标签" class="headerlink" title="package标签"></a>package标签</h3><ul>
<li><p>extends（继承）</p>
<blockquote>
<p>需要直接或者间接继承struts-default</p>
</blockquote>
</li>
<li><p>namespace（命名空间）</p>
<blockquote>
<p>例如当namespace=“/user”时，提交的路径需要以user/开头，并且当加上namespace时，结果集跳转路径不能省略/</p>
</blockquote>
<h2 id="action和result的配置详解"><a href="#action和result的配置详解" class="headerlink" title="action和result的配置详解"></a>action和result的配置详解</h2></li>
<li><p>name </p>
<blockquote>
<p>url的请求路径，不需要加后缀（.action）</p>
</blockquote>
</li>
<li><p>class </p>
<blockquote>
<p>url请求对应的java类（包名+类名）。该类由公共的无参构造方法创建（基于反射）</p>
</blockquote>
</li>
<li><p>method</p>
<blockquote>
<p>配置处理请求的方法，默认为execute 方法需要满足 【公共 无参 返回值为String】</p>
</blockquote>
</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;action <span class="built_in">name</span>=<span class="string">"login1"</span> <span class="built_in">class</span>=<span class="string">"com.lyb.action.LoginAction"</span> method=<span class="string">""</span>&gt;</span><br><span class="line">		&lt;<span class="literal">result</span> <span class="built_in">name</span>=<span class="string">"success"</span> type=<span class="string">""</span>&gt;index.jsp&lt;/<span class="literal">result</span>&gt;</span><br><span class="line">        &lt;<span class="literal">result</span> <span class="built_in">name</span>=<span class="string">"failed"</span>&gt;login.jsp&lt;/<span class="literal">result</span>&gt;</span><br><span class="line">&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>name</p>
<blockquote>
<p>匹配请求处理方法的返回值 默认为success</p>
</blockquote>
</li>
<li><p>type</p>
<blockquote>
<p>结果处理类型 默认为dispather（转发）</p>
<p>具体类型有哪些可以在struts-default.xml里查找</p>
</blockquote>
</li>
<li><p>chain：action连接，连接下一个action，也就是值为action标签的name属性</p>
</li>
<li><p>dispather：转发，与servlet的转发一致，如果request的数据要到视图层显示，使用dispather</p>
</li>
<li><p>redirect：重定向  如果重定向到jsp页面可以直接重定向，如果重定向到另一个action则需要注意后缀名，如果需要后缀名则一定要添加后缀名</p>
</li>
<li><p>redirectAction：重定向到另一个action，不用加后缀名</p>
</li>
<li><p>stream：以流的形式显示——文件下载</p>
</li>
</ul>
<h2 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h2><ul>
<li>配置全局结果集</li>
</ul>
<p>注意：全局结果集要在action前面</p>
<ul>
<li>配置默认class</li>
</ul>
<p>注意：不自行配置的话默认配置ActionSupport类</p>
<ul>
<li>配置默认的action</li>
</ul>
<p>注意：当请求的action不存在时，执行默认的action</p>
<ul>
<li>使用通配符简化action的配置<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">package</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">default-action-ref</span> <span class="attr">name</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">default-action-ref</span>&gt;</span>//默认的action</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">default-class-ref</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">default-class-ref</span>&gt;</span>//默认class</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">global-results</span>&gt;</span>//全局结果集</span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">result</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">global-results</span>&gt;</span></span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!--通配符* method对应的是第几个*的值 --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"login1*"</span> <span class="attr">class</span>=<span class="string">"com.lyb.action.LoginAction"</span> <span class="attr">method</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;1&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> &gt;</span></span></span><br><span class="line"><span class="xml">			</span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></span><br><span class="line"><span class="xml">	//常规的action</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="配置文件的加载顺序"><a href="#配置文件的加载顺序" class="headerlink" title="配置文件的加载顺序"></a>配置文件的加载顺序</h2><p>struts-default.xml—–&gt;struts-plugin.xml—–&gt;struts.xml</p>
<hr>
<h1 id="ActionContext对象"><a href="#ActionContext对象" class="headerlink" title="ActionContext对象"></a>ActionContext对象</h1><h2 id="ActionContext介绍"><a href="#ActionContext介绍" class="headerlink" title="ActionContext介绍"></a>ActionContext介绍</h2><blockquote>
<p>struts1的Action必须依赖于web容器,他的execute方法会自动获得HttpservletReqest.HttpsevletResponse对象,从而可以跟web容器进行交互。</p>
<p>struts2的Action不用依赖于web容器,本身只是一个普通的java类而已。但是,在web开发中我们往往需要获得request, session、application等对象。这时候,可以通过ActionContext来处理。</p>
<p>ActionContext正如其名,是Action执行的上下文。他内部有个map属性,它存放了Action执行时需要用到的对象。</p>
<p>在每次执行Action之前都会创建新的Actioncontext对象,所以Actioncontext是线程安全的。新new的Actioncontext是保存在一个Threadlocal变量中,即采用Threadlocal.模式。Threadlocal变量为每个线程提供独立的变量值的副本,使每个线程都可以独立的使用自己的副本,而不会和其他线程发生冲突。</p>
<p>通过ActionContext获取的session 、request,application并不是真正的HttpServletRequest.HttpSerMletResponse, SerletContext对象,而是将这三个对象里面的值重新包装成了mapwn<br>对象。这样的封装,我们及获取了我们需要的值,同时避免了跟Web容器直接打交道,实现了完全的解耦</p>
</blockquote>
<ul>
<li><p>ActionContext是map结构的容器，是Action的上下文，存放了Action执行过程中的数据信息。</p>
</li>
<li><p>每次请求都会为当前线程创建一个新的ActionContext（采用ThreadLocal方式存储） ，所以ActionContext是线程安全的</p>
</li>
</ul>
<h2 id="ActionContext的获取"><a href="#ActionContext的获取" class="headerlink" title="ActionContext的获取"></a>ActionContext的获取</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActionContext axt = <span class="module-access"><span class="module"><span class="identifier">ActionContext</span>.</span></span>get<span class="constructor">Context()</span>;</span><br></pre></td></tr></table></figure>
<p>由于ActionContext是线程安全的同时也是通过静态方法获取的，所以本线程中的非action类也可以进行访问/使用。</p>
<p><code>注意：ActionContext是基于请求创建的，所以在非请求线程中无法获取到ActionContext。</code></p>
<h2 id="ThreadLocal模式"><a href="#ThreadLocal模式" class="headerlink" title="ThreadLocal模式"></a>ThreadLocal模式</h2><p>ActionContext采用ThreadLocal方式存储信息保证线程安全</p>
<p>测试用例：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> </span>&#123;</span><br><span class="line">	<span class="comment">//ThreadLocal是存放线程局部变量的容器</span></span><br><span class="line">	<span class="comment">//存放在ThreadLocal的变量线程安全</span></span><br><span class="line">	<span class="keyword">final</span> ThreadLocal&lt;<span class="keyword">String</span>&gt; tl = <span class="keyword">new</span> ThreadLocal&lt;&gt;();</span><br><span class="line">	tl.<span class="built_in">set</span>(<span class="string">"sss"</span>);</span><br><span class="line">	<span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">		</span><br><span class="line">		@Override</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">run</span>() &#123;</span><br><span class="line">			System.out.<span class="built_in">println</span>(<span class="string">"Thread:"</span>+tl.<span class="built_in">get</span>());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;).start();</span><br><span class="line">	System.out.<span class="built_in">println</span>(tl.<span class="built_in">get</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ActionContext包含六大对象"><a href="#ActionContext包含六大对象" class="headerlink" title="ActionContext包含六大对象"></a>ActionContext包含六大对象</h2><h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://s2.ax1x.com/2020/01/25/1epgCq.png" alt="image"></h2><h1 id="struts2获取ServletApi"><a href="#struts2获取ServletApi" class="headerlink" title="struts2获取ServletApi"></a>struts2获取ServletApi</h1><h2 id="通过解耦的方式获取ServlertApi"><a href="#通过解耦的方式获取ServlertApi" class="headerlink" title="通过解耦的方式获取ServlertApi"></a>通过解耦的方式获取ServlertApi</h2><ol>
<li>通过ActionContext获取</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取session</span></span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">ActionContext</span>.</span></span>get<span class="constructor">Context()</span>.get<span class="constructor">Session()</span>.put(String key,Object   value);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取HttpServletRequest的Attributes</span></span><br><span class="line">Map&lt;String,Object&gt; request = <span class="module-access"><span class="module"><span class="identifier">ActionContext</span>.</span></span>get<span class="constructor">Context()</span>.get(<span class="string">"request"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取request对象的parameters</span></span><br><span class="line">Map&lt;String,Object&gt; parameters = <span class="module-access"><span class="module"><span class="identifier">ActionContext</span>.</span></span>get<span class="constructor">Context()</span>.get<span class="constructor">Parameters()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取apllication</span></span><br><span class="line">Map&lt;String,Object&gt; application = <span class="module-access"><span class="module"><span class="identifier">ActionContext</span>.</span></span>get<span class="constructor">Context()</span>.get<span class="constructor">Application()</span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>通过ActionContext直接获取HttpServletRequest</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HttpServletRequest request = (HttpServletRequest) <span class="module-access"><span class="module"><span class="identifier">ActionContext</span>.</span></span>get<span class="constructor">Context()</span>.get(StrutsStatics.HTTP_REQUEST);</span><br></pre></td></tr></table></figure>
<h2 id="通过耦合的方式获取ServletApi"><a href="#通过耦合的方式获取ServletApi" class="headerlink" title="通过耦合的方式获取ServletApi"></a>通过耦合的方式获取ServletApi</h2><ol>
<li>实现ServletRequestAware接口</li>
</ol>
<p>注：要获取response对象可以实现ServletResponseAware</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloAction</span> <span class="keyword">implements</span> <span class="title">ServletRequestAware</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	HttpServletRequest request;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"hello struts"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setServletRequest</span><span class="params">(HttpServletRequest res)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.request = res;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>通过ServletActionContext获取</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HttpServletRequest request = <span class="module-access"><span class="module"><span class="identifier">ServletActionContext</span>.</span></span>get<span class="constructor">Request()</span>;</span><br></pre></td></tr></table></figure>

<h1 id="值栈与Ognl表达式"><a href="#值栈与Ognl表达式" class="headerlink" title="值栈与Ognl表达式"></a>值栈与Ognl表达式</h1><h2 id="什么是值栈"><a href="#什么是值栈" class="headerlink" title="什么是值栈?"></a>什么是值栈?</h2><p>值栈（ValueStack）是ActionContext的一个对象。</p>
<p>值栈是栈结构，具有后进先出的特点</p>
<p>值栈存储的数据是Action对象</p>
<h2 id="Ognl表达式"><a href="#Ognl表达式" class="headerlink" title="Ognl表达式"></a>Ognl表达式</h2><p>全称： Object-Graph-Navigation-language(对象图导航语言)</p>
<p>原则：对象分成两类==常用的==和==不常用的==，常用的一般是小数据而不常用的一般是大数据</p>
<p>获取：常用的数据直接获取，不常用的数据加#获取</p>
<h3 id="ognl表达式的直接使用"><a href="#ognl表达式的直接使用" class="headerlink" title="ognl表达式的直接使用"></a>ognl表达式的直接使用</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> throws OgnlException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		Map&lt;<span class="keyword">String</span>,Object&gt; <span class="built_in">map</span> = <span class="keyword">new</span> HashMap();</span><br><span class="line">		<span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"name"</span>, <span class="string">"张三"</span>);</span><br><span class="line">		Student stu = <span class="keyword">new</span> Student();</span><br><span class="line">		stu.setName(<span class="string">"李四"</span>);</span><br><span class="line">	</span><br><span class="line">		Object obj = Ognl.getValue(<span class="string">"#name"</span>, <span class="built_in">map</span>, stu);<span class="comment">//getValue(String,Map,Object) ---ognl表达式、不常用数据、常用数据</span></span><br><span class="line">		System.out.<span class="built_in">println</span>(obj);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="struts2中使用ognl表达式"><a href="#struts2中使用ognl表达式" class="headerlink" title="struts2中使用ognl表达式"></a>struts2中使用ognl表达式</h3><p>用法：在struts2中通过标签使用ognl表达式</p>
<p>注意：在struts2中使用ognl表达式需要通过过滤器来启动，如果过滤器的配置为*.action结尾需要通过action来跳转不能直接访问jsp页面。</p>
<p>struts2推荐通过action来控制而不是直接访问jsp页面</p>
<p>使用： </p>
<ul>
<li>在jsp页面中导入标签库&lt;%@taglib prefix=”s” uri=”/struts-tags”%&gt;</li>
</ul>
<p>例子：</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=utf-8"</span></span></span><br><span class="line"><span class="ruby">    pageEncoding=<span class="string">"utf-8"</span></span><span class="xml">%&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">b</span>&gt;</span>登陆成功<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"name"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#session.user"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">-----</span></span><br><span class="line"><span class="xml">public class LoginAction &#123;</span></span><br><span class="line"><span class="xml">	private String name;</span></span><br><span class="line"><span class="xml">	private String pwd;</span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml">	public String execute() &#123;</span></span><br><span class="line"><span class="xml">		if(name.equals("lyb")&amp;&amp;pwd.equals("123")) &#123;</span></span><br><span class="line"><span class="xml">			ActionContext.getContext().getSession().put("user", name);</span></span><br><span class="line"><span class="xml">			return "success";</span></span><br><span class="line"><span class="xml">		&#125;else &#123;</span></span><br><span class="line"><span class="xml">			return "failed";</span></span><br><span class="line"><span class="xml">		&#125;</span></span><br><span class="line"><span class="xml">	&#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p><code>结论：action中的数据直接获取，ActionContext的数据加#获取</code></p>
<h1 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h1><ul>
<li><p>在servlet中，对于表单提供的非字符串类型需要手动进行类型转换</p>
</li>
<li><p>struts2能够对常用数据类型进行自动类型转换</p>
</li>
<li><p>对于自定义类型，struts2无法进行自动类型转换，那么需要手动进行转换。如果该类型转换的使用频率比较高则可以使用struts提供的类型转换器</p>
</li>
</ul>
<h2 id="类型转换器使用方法"><a href="#类型转换器使用方法" class="headerlink" title="类型转换器使用方法"></a>类型转换器使用方法</h2><ol>
<li>编写类型转换器—继承StrutsTypeConverter类</li>
<li>在src下编写xwork-conversion.properties的配置文件<ul>
<li>内容为：要转换的类型=类型转换器（类名+包名）</li>
</ul>
</li>
</ol>
<h3 id="编写类型转换器："><a href="#编写类型转换器：" class="headerlink" title="编写类型转换器："></a>编写类型转换器：</h3><p>当表单提交数据时，会调用<code>convertFromString</code>方法进行类型转换，该方法返回转换好的对象，并对action的对应属性进行赋值</p>
<p>当前台页面用ognl表达式输出action对应的属性时调用<code>convertToString</code>方法进行转换输出</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">PoniterConverter</span> <span class="keyword">extends</span> <span class="title">StrutsTypeConverter</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * arg0 是ActionContext对象</span></span><br><span class="line"><span class="comment">	 * arg1 是要转换的字符串数组</span></span><br><span class="line"><span class="comment">	 * arg2是被转换的类型</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	public <span class="type">Object</span> convertFromString(<span class="type">Map</span> arg0, <span class="type">String</span>[] arg1, <span class="type">Class</span> arg2) &#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 将字符串转换为前台数据显示， ----通过ognl表达式为调用该方法</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	public <span class="type">String</span> convertToString(<span class="type">Map</span> arg0, <span class="type">Object</span> arg1) &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>xwork-conversion.properties配置文件</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com<span class="selector-class">.lyb</span><span class="selector-class">.enty</span>.Poniter=com<span class="selector-class">.lyb</span><span class="selector-class">.converter</span>.PoniterConverter</span><br></pre></td></tr></table></figure>

<h1 id="struts2的验证机制"><a href="#struts2的验证机制" class="headerlink" title="struts2的验证机制"></a>struts2的验证机制</h1><h2 id="手动验证"><a href="#手动验证" class="headerlink" title="手动验证"></a>手动验证</h2><p>用法：action类需要继承ActionSupport类</p>
<p>作用：当继承ActionSupport类后，每一个请求来时会先执行==validate==验证方法,执行后才执行对应的调用方法。</p>
<h3 id="两种验证流程："><a href="#两种验证流程：" class="headerlink" title="两种验证流程："></a>两种验证流程：</h3><ol>
<li>请求的是execute方法</li>
</ol>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line"><span class="function"><span class="title">request</span>--&gt;</span>validate方法</span><br><span class="line"><span class="function"><span class="title">validate</span>方法--成功--&gt;</span>execue方法</span><br><span class="line"><span class="function"><span class="title">validate</span>方法--失败--&gt;</span>input视图</span><br><span class="line"><span class="function"><span class="title">execue</span>方法--&gt;</span>respond</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>请求的是自定义的xxx方法</li>
</ol>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line"><span class="function"><span class="title">request</span>--&gt;</span>validateXxx方法</span><br><span class="line"><span class="function"><span class="title">validateXxx</span>方法--成功--&gt;</span>validate方法</span><br><span class="line"><span class="function"><span class="title">validate</span>方法--失败--&gt;</span>input视图</span><br><span class="line"><span class="function"><span class="title">validateXxx</span>方法--失败--&gt;</span>input视图</span><br><span class="line"><span class="function"><span class="title">validate</span>方法--&gt;</span>xxx方法</span><br><span class="line"><span class="function"><span class="title">xxx</span>方法--&gt;</span>respond</span><br></pre></td></tr></table></figure>

<p><code>在jsp页面通过&lt;s:actionerror/actionmessge&gt;取出信息</code></p>
<h3 id="验证案例："><a href="#验证案例：" class="headerlink" title="验证案例："></a>验证案例：</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">action类 继承ActionSupport</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegisterAction</span> <span class="title">extends</span> <span class="title">ActionSupport</span>&#123;</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> id;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> password;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validateAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(age&gt;<span class="number">120</span>||age&lt;<span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">this</span>.addActionError(<span class="string">"年龄不合法"</span>);<span class="comment">//会跳转到input，不会执行execute方法</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	@Override</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">age</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">String</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(<span class="keyword">String</span> password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>struts.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.5.dtd"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"default"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/"</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"register"</span> <span class="attr">class</span>=<span class="string">"com.lyb.acion.RegisterAction"</span> <span class="attr">method</span>=<span class="string">"age"</span>&gt;</span> </span><br><span class="line"> 				<span class="tag">&lt;<span class="name">result</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>/index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line"> <span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>index.jsp页面</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=utf-8"</span></span></span><br><span class="line"><span class="ruby">    pageEncoding=<span class="string">"utf-8"</span></span><span class="xml">%&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@taglib uri=<span class="string">"/struts-tags"</span> prefix=<span class="string">"s"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>验证<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">s:actionerror</span>/&gt;</span>//取出验证提示错误信息</span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"register.action"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		用户ID：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"id"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		年龄：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"age"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>success.jsp页面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=utf-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"utf-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	验证成功。</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="验证框架的使用"><a href="#验证框架的使用" class="headerlink" title="验证框架的使用"></a>验证框架的使用</h2><p>使用验证框架的步骤：</p>
<ol>
<li><p>Action类要继承ActionSupport类</p>
</li>
<li><p>在对应的action类的包下，建一个验证框架的配置文件，该配置文件的名称必须为==action类名-validation.xml==</p>
</li>
</ol>
<p>例如: 一个名为<strong>AddACtion</strong>的类，对应的验证框架配置文件为<strong>AddAction-validation.xml</strong></p>
<ol start="3">
<li>在配置文件里配置对应需验证属性的验证信息</li>
</ol>
<p>注意： 各种验证及其属性具体信息可以查看struts-core下xwork-validators的类</p>
<p>案例：</p>
<p>jsp页面</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action="register.action" <span class="keyword">method</span>="post"&gt;</span><br><span class="line">		用户ID：&lt;<span class="keyword">input</span> <span class="keyword">type</span>="text" <span class="type">name</span>="id"/&gt;</span><br><span class="line">		密码：&lt;<span class="keyword">input</span> <span class="keyword">type</span>="password" <span class="type">name</span>="password"/&gt;</span><br><span class="line">		年龄：&lt;<span class="keyword">input</span> <span class="keyword">type</span>="text" <span class="type">name</span>="age"/&gt;</span><br><span class="line">		&lt;<span class="keyword">input</span> <span class="keyword">type</span>="submit" <span class="keyword">value</span>="提交"/&gt;</span><br><span class="line">	&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p>Action类</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegisterValidateAction</span> <span class="title">extends</span> <span class="title">ActionSupport</span>&#123;</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> id;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> password;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">String</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(<span class="keyword">String</span> password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>action对应的验证框架</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">validators</span> <span class="meta-keyword">PUBLIC</span></span></span></span><br><span class="line"><span class="xml">   "-//Apache Struts//XWork Validator 1.0.3//EN"</span></span><br><span class="line"><span class="xml">   "http://struts.apache.org/dtds/xwork-validator-1.0.3.dtd"&gt; </span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">validators</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 	<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"id"</span>&gt;</span>//-----------name的值对应表单提交的name值</span></span><br><span class="line"><span class="xml"> 		<span class="tag">&lt;<span class="name">field-validator</span> <span class="attr">type</span>=<span class="string">"requiredstring"</span>&gt;</span>//------使用的验证器</span></span><br><span class="line"><span class="xml"> 			<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"trim"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param</span>&gt;</span>//--------验证</span></span><br><span class="line"><span class="xml"> 			<span class="tag">&lt;<span class="name">message</span>&gt;</span>id必须为空<span class="tag">&lt;/<span class="name">message</span>&gt;</span>//-----------验证失败添加信息，并跳转到input页面</span></span><br><span class="line"><span class="xml"> 		<span class="tag">&lt;/<span class="name">field-validator</span>&gt;</span> 	</span></span><br><span class="line"><span class="xml"> 	<span class="tag">&lt;/<span class="name">field</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 	</span></span><br><span class="line"><span class="xml"> 	<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"age"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 		<span class="tag">&lt;<span class="name">field-validator</span> <span class="attr">type</span>=<span class="string">"int"</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 			<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"min"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 			<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"max"</span>&gt;</span>120<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 			<span class="tag">&lt;<span class="name">message</span>&gt;</span>年龄不合理,范围在$</span><span class="template-variable">&#123;min&#125;</span><span class="xml">到$</span><span class="template-variable">&#123;max&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 		<span class="tag">&lt;/<span class="name">field-validator</span>&gt;</span></span></span><br><span class="line"><span class="xml"> 	</span></span><br><span class="line"><span class="xml"> 	<span class="tag">&lt;/<span class="name">field</span>&gt;</span></span></span><br><span class="line"><span class="xml"> </span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">validators</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>struts.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.5.dtd"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"default"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/"</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"register"</span> <span class="attr">class</span>=<span class="string">"com.lyb.acion.RegisterValidateAction"</span>&gt;</span> </span><br><span class="line"> 				<span class="tag">&lt;<span class="name">result</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>/index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line"> <span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h1><h2 id="什么是拦截器、拦截器栈"><a href="#什么是拦截器、拦截器栈" class="headerlink" title="什么是拦截器、拦截器栈?"></a>什么是拦截器、拦截器栈?</h2><ul>
<li><p>Interceptor拦器类似于我们前面学过的过滤器,是可以在action执行前后执行的代 是我们做web开发时经常用的技术。比如:权限控制、日志等。我们也可以将多个Interceptor连在一起组成Interceptor 栈。</p>
</li>
<li><p>struts2拦截器,每个拦截器类只有一个对象实例,即采用==单例模式==,所有引用这个拦截器的Action都共享这一拦截器类的实例,因此,在拦截器中如果使用类变量,==要注意同步问题==。</p>
<ul>
<li><p>拦截器是在访问某个方法,字段之前或之后实施拦截。</p>
</li>
<li><p>拦截器是AOP的一种实现</p>
</li>
<li><p>拦截器栈(Interceptor stack)就是将拦截器按一定的顺序联结成一条链。<br>在访问被拦截的方法或字段时,拦截器链中的拦截器就会按其之前定义的顺序被调用。</p>
</li>
</ul>
</li>
</ul>
<h2 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h2><p>struts2拦截器的实现原理相对简单,当请求struts2的action时, struts 2会查找配置文件,并根据其配密实例化相对应拦截器对象,然后串成一个列表,最后一个一个地调用列表中的拦截器</p>
<h2 id="拦截器作用"><a href="#拦截器作用" class="headerlink" title="拦截器作用"></a>拦截器作用</h2><p>一些action的公共代码可以放到拦截器里面</p>
<h2 id="拦截器与过滤器的区别"><a href="#拦截器与过滤器的区别" class="headerlink" title="拦截器与过滤器的区别"></a>拦截器与过滤器的区别</h2><ul>
<li>过滤器隶属web容器可以过滤一切请求（action、servlet、jsp、html）</li>
<li>拦截器隶属struts2,只能拦截action</li>
<li>过滤器内部使用函数回调实现、而拦截器采用动态代理实现<h2 id="拦截器实现步骤"><a href="#拦截器实现步骤" class="headerlink" title="拦截器实现步骤"></a>拦截器实现步骤</h2></li>
</ul>
<ol>
<li><p>编写拦截器类(实现Interceptor接口或者继承AbstractInterceptor类)</p>
</li>
<li><p>在struts.xml中配置拦截器</p>
</li>
<li><p>在action中引用拦截器</p>
</li>
</ol>
<p>案例：</p>
<p>拦截器类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeInterceptor</span> <span class="keyword">implements</span> <span class="title">Interceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">intercept</span><span class="params">(ActionInvocation invocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">		<span class="comment">//执行下一个拦截器，直到执行action获取action返回的结果</span></span><br><span class="line">		String result = invocation.invoke();</span><br><span class="line">		<span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">		System.out.println(<span class="string">"action共执行："</span>+(end-start)+<span class="string">"ms"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将结果返回给上一个拦截器</span></span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在struts.xml配置拦截器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"default"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/"</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 拦截器配置在package标签下，可以配置多个拦截器 --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">interceptors</span> &gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"time"</span> <span class="attr">class</span>=<span class="string">"com.lyb.interceptor.TimeInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line"> 		</span><br><span class="line"> 		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"com.lyb.acion.HelloAction"</span>&gt;</span></span><br><span class="line"> 			<span class="comment">&lt;!-- 引用拦截器 --&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"time"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">result</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line"> <span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="拦截器配置详解"><a href="#拦截器配置详解" class="headerlink" title="拦截器配置详解"></a>拦截器配置详解</h2><ul>
<li>当配置了自定义拦截器后，默认拦截器将不起作用</li>
<li>在struts-default.xml中，配置了默认拦截器，当不引用自定义拦截器，默认拦截器将起作用<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;interceptor-stack <span class="built_in">name</span>=<span class="string">"completeStack"</span>&gt;</span><br><span class="line">        &lt;interceptor-<span class="keyword">ref</span> <span class="built_in">name</span>=<span class="string">"defaultStack"</span>/&gt;</span><br><span class="line"> &lt;/interceptor-stack&gt;</span><br></pre></td></tr></table></figure></li>
<li>当引用了自定义拦截器后，想使用默认拦截器需要手动引用<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"com.lyb.acion.HelloAction"</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 引用拦截器 --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"time"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 手动引用默认拦截器 --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">result</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>当action需要引用的拦截器较多时可以使用拦截器栈<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"default"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/"</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 拦截器配置在package标签下，可以配置多个拦截器 --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">interceptors</span> &gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"time"</span> <span class="attr">class</span>=<span class="string">"com.lyb.interceptor.TimeInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line"> 			</span><br><span class="line"> 			<span class="comment">&lt;!-- 拦截器栈可以包含多个拦截器/拦截器栈 --&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"myStack"</span>&gt;</span></span><br><span class="line"> 				<span class="comment">&lt;!-- 引用拦截器 --&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"time"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 				<span class="comment">&lt;!-- 手动引用默认拦截器 --&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 			</span><br><span class="line"> 			<span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"> 		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"com.lyb.acion.HelloAction"</span>&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"myStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">result</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line"> <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>当包下所有的action都要使用某拦截器/拦截器栈时，可以将其定义为默认拦截器/拦截器栈</li>
</ul>
<p>==要注意位置：interceptoe—-defalut-interceptor—-action==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 拦截器配置在package标签下，可以配置多个拦截器 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">interceptors</span> &gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"time"</span> <span class="attr">class</span>=<span class="string">"com.lyb.interceptor.TimeInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">&lt;!-- 拦截器栈可以包含多个拦截器/拦截器栈 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"myStack"</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- 引用拦截器 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"time"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- 手动引用默认拦截器 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!--自定义默认拦截器/拦截器栈--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">default-interceptor-ref</span> <span class="attr">name</span>=<span class="string">"myStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">default-interceptor-ref</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span><span class="attr">class</span>=<span class="string">"com.lyb.acion.HelloAction"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="方法拦截器"><a href="#方法拦截器" class="headerlink" title="方法拦截器"></a>方法拦截器</h2><p>作用：可以拦截指定的action执行方法</p>
<p>用法步骤：</p>
<ul>
<li>编写方法拦截器 继承==MethodFilterInterceptor==类</li>
<li>配置方法拦截器</li>
<li>引用方法拦截器</li>
</ul>
<p>案例：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">方法拦截器</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MethodInterceptor</span> <span class="keyword">extends</span> <span class="title">MethodFilterInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="type">String</span> doIntercept(<span class="type">ActionInvocation</span> invocation) <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">		<span class="type">System</span>.out.println(<span class="string">"方法拦截器被执行"</span>);</span><br><span class="line">		<span class="keyword">return</span> invocation.invoke();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptors</span> &gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"time"</span> <span class="attr">class</span>=<span class="string">"com.lyb.interceptor.TimeInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置方法拦截器 </span></span><br><span class="line"><span class="comment">            通过includeMethods属性配置需要拦截的方法</span></span><br><span class="line"><span class="comment">            通过excludeMethods属性配置不需要拦截的方法 </span></span><br><span class="line"><span class="comment">            多个方法用逗号隔开</span></span><br><span class="line"><span class="comment">            --&gt;</span> 	    </span><br><span class="line"> 	    	<span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"method"</span> <span class="attr">class</span>=<span class="string">"com.lyb.interceptor.MethodInterceptor"</span>&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"includeMethods"</span>&gt;</span>list<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line"> 			<span class="comment">&lt;!-- 拦截器栈可以包含多个拦截器/拦截器栈 --&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"myStack"</span>&gt;</span></span><br><span class="line"> 				<span class="comment">&lt;!-- 引用拦截器 --&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"method"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"time"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 				<span class="comment">&lt;!-- 手动引用默认拦截器 --&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 			</span><br><span class="line"> 			<span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line"> 		</span><br><span class="line"> 		<span class="tag">&lt;<span class="name">1--引用方法拦截器--</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"list"</span> <span class="attr">class</span>=<span class="string">"com.lyb.acion.HelloAction"</span> <span class="attr">method</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"myStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">result</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><h2 id="单文件上传"><a href="#单文件上传" class="headerlink" title="单文件上传"></a>单文件上传</h2><p>案例:</p>
<p>jsp页面</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">       注意</span></span><br><span class="line"><span class="comment">       1.entype属性改写成multipart/form-data，代表可以上传各种类型的文件</span></span><br><span class="line"><span class="comment">       2.必须要用post方法</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">&lt;form action="upload.action" <span class="keyword">method</span>="post" enctype="multipart/form-data"&gt;</span><br><span class="line">	&lt;<span class="keyword">input</span> <span class="keyword">type</span>="file" <span class="type">name</span>="file"/&gt;</span><br><span class="line">	&lt;<span class="keyword">input</span> <span class="keyword">type</span>="submit" <span class="keyword">value</span>="上传"/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p>action类</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadAction</span> <span class="title">extends</span> <span class="title">ActionSupport</span>&#123;</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">File</span> file;<span class="comment">//接收表单上传的文件</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> fileFileName;<span class="comment">//文件的名称</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> fileContentType;<span class="comment">//文件的类型</span></span><br><span class="line">	</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">upload</span><span class="params">()</span> throws IOException </span>&#123;</span><br><span class="line">			HttpServletRequest req = ServletActionContext.getRequest();</span><br><span class="line">			<span class="keyword">String</span> path = req.getRealPath(<span class="string">"/upload"</span>);</span><br><span class="line">			System.out.<span class="built_in">println</span>(path);</span><br><span class="line">			InputStream is = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">			OutputStream os = <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> <span class="built_in">File</span>(path,fileFileName));</span><br><span class="line">			<span class="keyword">byte</span>[] <span class="built_in">buffer</span> = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line"> 			<span class="keyword">int</span> len;</span><br><span class="line"> 			<span class="keyword">while</span>((len=is.<span class="built_in">read</span>(<span class="built_in">buffer</span>))!=<span class="number">-1</span>) &#123;</span><br><span class="line"> 				os.<span class="built_in">write</span>(<span class="built_in">buffer</span>);</span><br><span class="line"> 				os.<span class="built_in">flush</span>();</span><br><span class="line"> 			&#125;</span><br><span class="line">			os.<span class="built_in">close</span>();</span><br><span class="line">			is.<span class="built_in">close</span>();</span><br><span class="line">			<span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="comment">//get set 方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="多文件上传"><a href="#多文件上传" class="headerlink" title="多文件上传"></a>多文件上传</h2><p>多文件上传可以理解为上传到action类的是一个file数组</p>
<h1 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h1><p>文件下载案例</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"download.action"</span>&gt;</span>下载思维导图<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;action <span class="attribute">name</span>=<span class="string">"download"</span> <span class="attribute">class</span>=<span class="string">"cn.lyb.action.DownLoadAction"</span>&gt;&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 下载文件</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> * @throws IOException </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span> throws IOException </span>&#123;</span><br><span class="line">	<span class="comment">//获取请求对象</span></span><br><span class="line">	HttpServletRequest req = ServletActionContext.getRequest();</span><br><span class="line">	<span class="comment">//获取响应对象</span></span><br><span class="line">	HttpServletResponse resp = ServletActionContext.getResponse();</span><br><span class="line">	<span class="comment">//获取资源文件路径</span></span><br><span class="line">	<span class="keyword">String</span> path = req.getRealPath(<span class="string">"/download"</span>);</span><br><span class="line">	<span class="comment">//获取取资源文件，此文件在path目录下</span></span><br><span class="line">	<span class="built_in">File</span> file = <span class="keyword">new</span> <span class="built_in">File</span>(path,<span class="string">"CD.bmd"</span>);</span><br><span class="line">	<span class="comment">//设置响应信息</span></span><br><span class="line">	resp.setContentLength((<span class="keyword">int</span>)file.length());</span><br><span class="line">	resp.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">	resp.setHeader(<span class="string">"Content-Disposition"</span>, <span class="string">"attachment;filename=CD.bmd"</span>);</span><br><span class="line">	resp.setContentType(<span class="string">"application/octet-stream"</span>); <span class="comment">//applicatiga/octet-stream..application/x-madonlsed可选参数</span></span><br><span class="line">	<span class="comment">//创建输入输出流</span></span><br><span class="line">	InputStream is = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">	OutputStream os = resp.getOutputStream();</span><br><span class="line">	<span class="comment">//准备缓冲数组</span></span><br><span class="line">	<span class="keyword">byte</span>[] <span class="built_in">buffer</span> = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">	<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//写出文件</span></span><br><span class="line">	<span class="keyword">while</span>((len=is.<span class="built_in">read</span>(<span class="built_in">buffer</span>))!=<span class="number">-1</span>) &#123;</span><br><span class="line">		os.<span class="built_in">write</span>(<span class="built_in">buffer</span>,<span class="number">0</span>,len);</span><br><span class="line">		os.<span class="built_in">flush</span>();</span><br><span class="line">	&#125;</span><br><span class="line">		<span class="comment">//关闭流</span></span><br><span class="line">	os.<span class="built_in">close</span>();</span><br><span class="line">	is.<span class="built_in">close</span>();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> null;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="strutsApi实现ajax"><a href="#strutsApi实现ajax" class="headerlink" title="strutsApi实现ajax"></a>strutsApi实现ajax</h1><h2 id="使用原生struts2实现ajax"><a href="#使用原生struts2实现ajax" class="headerlink" title="使用原生struts2实现ajax"></a>使用原生struts2实现ajax</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery-3 .3.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">		$(<span class="string">'#btn'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			$.post(<span class="string">"ajax.action"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span></span><br><span class="line">				</span><br><span class="line"><span class="javascript">				$(<span class="string">'#msg'</span>).html(data);</span></span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"获取ajax信息"</span> <span class="attr">id</span>=<span class="string">"btn"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h3</span> <span class="attr">id</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AjaxAction</span> &#123;</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span> throws IOException </span>&#123;</span><br><span class="line">		HttpServletResponse resp =  ServletActionContext.getResponse();</span><br><span class="line">		resp.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">		resp.getWriter().<span class="built_in">write</span>(<span class="string">"暗淡青黄体性柔"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> null;</span><br><span class="line">				</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;action <span class="attribute">name</span>=<span class="string">"ajax"</span> <span class="attribute">class</span>=<span class="string">"cn.lyb.action.AjaxAction"</span>&gt;&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<h2 id="使用struts2插件实现ajax-json格式-处理"><a href="#使用struts2插件实现ajax-json格式-处理" class="headerlink" title="使用struts2插件实现ajax(json格式)处理"></a>使用struts2插件实现ajax(json格式)处理</h2><p>使用struts2实现json需要导入下列的jar包</p>
<p><img src="https://s2.ax1x.com/2020/01/25/1e99IA.png" alt="image"></p>
<p>jsp页面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery-3.3.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">		$(<span class="string">'#btn'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			$.post(<span class="string">"json.action"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript">				<span class="keyword">var</span> html =<span class="string">""</span>;</span></span><br><span class="line"><span class="actionscript">				<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;data.length;i++)&#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">			    	html+="<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>"+data[i].name+"<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>"+data[i].age+"<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>"</span></span></span><br><span class="line">				&#125;</span><br><span class="line"><span class="javascript">				$(<span class="string">'#content'</span>).html(html);</span></span><br><span class="line"><span class="actionscript">			&#125;,<span class="string">'json'</span>);</span></span><br><span class="line">			</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"获取json信息"</span> <span class="attr">id</span>=<span class="string">"btn"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">"80%"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">td</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">td</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>struts.xml</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    注意</span></span><br><span class="line"><span class="comment">        1.要继承json-default</span></span><br><span class="line"><span class="comment">        2.结果集的类型要为json</span></span><br><span class="line"><span class="comment">        3.需要设置参数param的root</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&lt;package <span class="built_in">name</span>=<span class="string">"default2"</span> extends=<span class="string">"json-default"</span> namespace=<span class="string">"/"</span>&gt;</span><br><span class="line">		&lt;<span class="built_in">action</span> <span class="built_in">name</span>=<span class="string">"json"</span> class=<span class="string">"cn.lyb.action.JosnAction"</span>&gt;</span><br><span class="line">			&lt;result <span class="built_in">type</span>=<span class="string">"json"</span>&gt;</span><br><span class="line">				&lt;<span class="built_in">param</span> <span class="built_in">name</span>=<span class="string">"root"</span>&gt;root&lt;/<span class="built_in">param</span>&gt;</span><br><span class="line">			&lt;/result&gt;</span><br><span class="line">		&lt;/<span class="built_in">action</span>&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/package&gt;</span><br></pre></td></tr></table></figure>
<p>action类</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JosnAction</span> &#123;</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> JSONArray root;</span><br><span class="line">	<span class="comment">//如果是单个对象可以使用JSONObject</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		List&lt;User&gt; <span class="built_in">list</span> = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		<span class="built_in">list</span>.add(<span class="keyword">new</span> User(<span class="string">"小明"</span>,<span class="number">25</span>));</span><br><span class="line">		<span class="built_in">list</span>.add(<span class="keyword">new</span> User(<span class="string">"小宏"</span>,<span class="number">24</span>));</span><br><span class="line">		<span class="built_in">list</span>.add(<span class="keyword">new</span> User(<span class="string">"小阿三"</span>,<span class="number">23</span>));</span><br><span class="line">		root = JSONArray.fromObject(<span class="built_in">list</span>);<span class="comment">//将Object类型数据转换成json格式 </span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONArray <span class="title">getRoot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> root;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoot</span><span class="params">(JSONArray root)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.root = root;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </div>

    
    
    
	
	<div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/2020/01/24/backEnd/framework/Struts2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">struts2学习笔记</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 liuyoubin 的个人博客">liuyoubin</a></p>
  <p><span>发布时间:</span>2020年01月24日 - 23:39</p>
  <p><span>最后更新:</span>2020年02月03日 - 15:30</p>
  <p><span>原始链接:</span><a href="/2020/01/24/backEnd/framework/Struts2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="struts2学习笔记">http://liuyoubin.top/2020/01/24/backEnd/framework/Struts2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://liuyoubin.top/2020/01/24/backEnd/framework/Struts2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: '复制成功',
          icon: "success", 
          showConfirmButton: true
          });
    });
    });  
</script>

      
	</div>
	  
	  <div>
		
			<div>
    
        <div style="text-align:center;color: #bbb;font-size:22px;">-------------本文结束<i class="fa fa-star"></i>感谢您的阅读-------------</div>
    
</div>
		
	  </div>
	  

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Struts2/" rel="tag"><i class="fa fa-tag"></i> Struts2</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/01/24/backEnd/framework/MyBatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="prev" title="MyBatis学习笔记">
      <i class="fa fa-chevron-left"></i> MyBatis学习笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/01/25/backEnd/framework/Shrio%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="next" title="Shrio学习笔记">
      Shrio学习笔记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Struts2入门"><span class="nav-number">1.</span> <span class="nav-text">Struts2入门</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#搭建struts2项目的步骤"><span class="nav-number">1.1.</span> <span class="nav-text">搭建struts2项目的步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#struts2执行流程"><span class="nav-number">1.2.</span> <span class="nav-text">struts2执行流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#详细流程"><span class="nav-number">1.3.</span> <span class="nav-text">详细流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#用struts2搭建一个简单登陆案例"><span class="nav-number">1.4.</span> <span class="nav-text">用struts2搭建一个简单登陆案例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#struts2线程安全问题"><span class="nav-number">2.</span> <span class="nav-text">struts2线程安全问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#线程安全的概念"><span class="nav-number">2.1.</span> <span class="nav-text">线程安全的概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#struts2线程安全？"><span class="nav-number">2.2.</span> <span class="nav-text">struts2线程安全？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#action的实现方式以及表单数据的处理"><span class="nav-number">3.</span> <span class="nav-text">action的实现方式以及表单数据的处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#action的三种实现方法"><span class="nav-number">3.1.</span> <span class="nav-text">action的三种实现方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#以对象的方式处理表单数据"><span class="nav-number">3.2.</span> <span class="nav-text">以对象的方式处理表单数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#属性驱动"><span class="nav-number">3.2.1.</span> <span class="nav-text">属性驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模型驱动（ModelDriven）"><span class="nav-number">3.2.2.</span> <span class="nav-text">模型驱动（ModelDriven）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#struts2配置文件详解"><span class="nav-number">4.</span> <span class="nav-text">struts2配置文件详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#struts-xml的标签"><span class="nav-number">4.1.</span> <span class="nav-text">struts.xml的标签</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#constant标签"><span class="nav-number">4.1.1.</span> <span class="nav-text">constant标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#include标签"><span class="nav-number">4.1.2.</span> <span class="nav-text">include标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#package标签"><span class="nav-number">4.1.3.</span> <span class="nav-text">package标签</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#action和result的配置详解"><span class="nav-number">4.2.</span> <span class="nav-text">action和result的配置详解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#全局配置"><span class="nav-number">4.3.</span> <span class="nav-text">全局配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置文件的加载顺序"><span class="nav-number">4.4.</span> <span class="nav-text">配置文件的加载顺序</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ActionContext对象"><span class="nav-number">5.</span> <span class="nav-text">ActionContext对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ActionContext介绍"><span class="nav-number">5.1.</span> <span class="nav-text">ActionContext介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ActionContext的获取"><span class="nav-number">5.2.</span> <span class="nav-text">ActionContext的获取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ThreadLocal模式"><span class="nav-number">5.3.</span> <span class="nav-text">ThreadLocal模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ActionContext包含六大对象"><span class="nav-number">5.4.</span> <span class="nav-text">ActionContext包含六大对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#null"><span class="nav-number">5.5.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#struts2获取ServletApi"><span class="nav-number">6.</span> <span class="nav-text">struts2获取ServletApi</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#通过解耦的方式获取ServlertApi"><span class="nav-number">6.1.</span> <span class="nav-text">通过解耦的方式获取ServlertApi</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通过耦合的方式获取ServletApi"><span class="nav-number">6.2.</span> <span class="nav-text">通过耦合的方式获取ServletApi</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#值栈与Ognl表达式"><span class="nav-number">7.</span> <span class="nav-text">值栈与Ognl表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是值栈"><span class="nav-number">7.1.</span> <span class="nav-text">什么是值栈?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ognl表达式"><span class="nav-number">7.2.</span> <span class="nav-text">Ognl表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ognl表达式的直接使用"><span class="nav-number">7.2.1.</span> <span class="nav-text">ognl表达式的直接使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#struts2中使用ognl表达式"><span class="nav-number">7.2.2.</span> <span class="nav-text">struts2中使用ognl表达式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#类型转换"><span class="nav-number">8.</span> <span class="nav-text">类型转换</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#类型转换器使用方法"><span class="nav-number">8.1.</span> <span class="nav-text">类型转换器使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#编写类型转换器："><span class="nav-number">8.1.1.</span> <span class="nav-text">编写类型转换器：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#struts2的验证机制"><span class="nav-number">9.</span> <span class="nav-text">struts2的验证机制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#手动验证"><span class="nav-number">9.1.</span> <span class="nav-text">手动验证</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#两种验证流程："><span class="nav-number">9.1.1.</span> <span class="nav-text">两种验证流程：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#验证案例："><span class="nav-number">9.1.2.</span> <span class="nav-text">验证案例：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#验证框架的使用"><span class="nav-number">9.2.</span> <span class="nav-text">验证框架的使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#拦截器"><span class="nav-number">10.</span> <span class="nav-text">拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是拦截器、拦截器栈"><span class="nav-number">10.1.</span> <span class="nav-text">什么是拦截器、拦截器栈?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现原理"><span class="nav-number">10.2.</span> <span class="nav-text">实现原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拦截器作用"><span class="nav-number">10.3.</span> <span class="nav-text">拦截器作用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拦截器与过滤器的区别"><span class="nav-number">10.4.</span> <span class="nav-text">拦截器与过滤器的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拦截器实现步骤"><span class="nav-number">10.5.</span> <span class="nav-text">拦截器实现步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拦截器配置详解"><span class="nav-number">10.6.</span> <span class="nav-text">拦截器配置详解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#方法拦截器"><span class="nav-number">10.7.</span> <span class="nav-text">方法拦截器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件上传"><span class="nav-number">11.</span> <span class="nav-text">文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#单文件上传"><span class="nav-number">11.1.</span> <span class="nav-text">单文件上传</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多文件上传"><span class="nav-number">11.2.</span> <span class="nav-text">多文件上传</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件下载"><span class="nav-number">12.</span> <span class="nav-text">文件下载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#strutsApi实现ajax"><span class="nav-number">13.</span> <span class="nav-text">strutsApi实现ajax</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#使用原生struts2实现ajax"><span class="nav-number">13.1.</span> <span class="nav-text">使用原生struts2实现ajax</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用struts2插件实现ajax-json格式-处理"><span class="nav-number">13.2.</span> <span class="nav-text">使用struts2插件实现ajax(json格式)处理</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="liuyoubin"
      src="/images/xfc.jpg">
  <p class="site-author-name" itemprop="name">liuyoubin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
        
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/734635746" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;734635746" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:734635746@qq.com" title="E-Mail → mailto:734635746@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-email"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i>RSS</a>
      </span>
  </div>



      </div>
		
		<!--粒子时钟-->
		 
           
         
        <div style="">
  <canvas id="canvas" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();
</script>
		
		
		
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        




<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liuyoubin</span>
</div>

<!--
	
	
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.0
  </div>
-->

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("01/01/2020 17:38:00");//在此处修改你的建站时间
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本小站已运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

  
  
	<script type="text/javascript" src="/js/jq/jquery-3.3.1.js" ></script>
  
    <script src="/js/cursor/fireworks.js"></script>
  

  
</body>
</html>
